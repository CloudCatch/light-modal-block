(()=>{"use strict";class e{openTrigger="data-trigger-modal";closeTrigger="wp-block-cloudcatch-simple-modal-block__close";openClass="is-open";focusableElements='a[href],area[href],input:not([disabled]):not([type="hidden"]):not([aria-hidden]),select:not([disabled]):not([aria-hidden]),textarea:not([disabled]):not([aria-hidden]),button:not([disabled]):not([aria-hidden]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])';constructor(e){let{targetModal:t,triggers:o=[]}=e;this.modal=document.querySelector(`[data-modal-id="${t}"]`),o.length>0&&this.registerTriggers(...o),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}registerTriggers(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];t.filter(Boolean).forEach((e=>{e.addEventListener("click",(e=>this.showModal(e)))}))}showModal(){this.activeElement=document.activeElement,this.modal.classList.add(this.openClass),this.addEventListeners(),this.setFocusToFirstNode()}closeModal(){const e=this.modal;this.removeEventListeners(),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),e.classList.remove(this.openClass)}closeModalById(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}addEventListeners(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}removeEventListeners(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}onClick(e){(e.target.classList.contains(this.closeTrigger)||e.target.parentNode.classList.contains(this.closeTrigger)||e.target.classList.contains("wp-block-cloudcatch-simple-modal-block__wrapper"))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}onKeydown(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}getFocusableNodes(){const e=this.modal.querySelectorAll(this.focusableElements);return Array(...e)}setFocusToFirstNode(){const e=this.getFocusableNodes();if(0===e.length)return;const t=e.filter((e=>!e.classList.contains(this.closeTrigger)));t.length>0&&t[0].focus(),0===t.length&&e[0].focus()}retainFocus(e){let t=this.getFocusableNodes();if(0===t.length)return;t=t.filter((e=>null!==e.offsetParent));const o=t.indexOf(document.activeElement);e.shiftKey&&0===o&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&o===t.length-1&&(t[0].focus(),e.preventDefault())}}window.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".wp-block-cloudcatch-simple-modal-block__wrapper").forEach((t=>{const o=t.getAttribute("data-modal-id"),s=t.getAttribute("data-trigger-selector"),i=parseInt(t.getAttribute("data-trigger-delay")),n=Object.assign({},{openTrigger:"data-trigger-modal"}),a=[...document.querySelectorAll(`[${n.openTrigger}="${o}"]`),...document.querySelectorAll(`${s}`)];n.targetModal=o,n.triggers=a;const l=new e(n);i&&setTimeout((()=>l.showModal()),i)}))}))})();