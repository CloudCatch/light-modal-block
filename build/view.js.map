{"version":3,"file":"view.js","mappings":"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","sources":["webpack://simple-modal-block/./src/view/modal.ts","webpack://simple-modal-block/webpack/bootstrap","webpack://simple-modal-block/webpack/runtime/define property getters","webpack://simple-modal-block/webpack/runtime/hasOwnProperty shorthand","webpack://simple-modal-block/webpack/runtime/make namespace object","webpack://simple-modal-block/./src/view.js"],"sourcesContent":["export default class Modal {\n\tmodal: HTMLElement;\n\n\topenTrigger: string = 'data-trigger-modal';\n\n\tcloseTrigger: string = 'wp-block-cloudcatch-simple-modal-block__close';\n\n\topenClass: string = 'is-open';\n\n\tactiveElement: Element;\n\n\tfocusableElements: string =\n\t\t'a[href],area[href],input:not([disabled]):not([type=\"hidden\"]):not([aria-hidden]),select:not([disabled]):not([aria-hidden]),textarea:not([disabled]):not([aria-hidden]),button:not([disabled]):not([aria-hidden]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^=\"-\"])';\n\n\tconstructor( { targetModal, triggers = [] } ) {\n\t\t// Save a reference of the modal\n\t\tthis.modal = document.querySelector(\n\t\t\t`[data-modal-id=\"${ targetModal }\"]`\n\t\t);\n\n\t\t// Register click events only if pre binding eventListeners\n\t\tif ( triggers.length > 0 ) this.registerTriggers( ...triggers );\n\n\t\t// pre bind functions for event listeners\n\t\tthis.onClick = this.onClick.bind( this );\n\t\tthis.onKeydown = this.onKeydown.bind( this );\n\t}\n\n\t/**\n\t * Loops through all openTriggers and binds click event\n\t *\n\t * @param {Array} triggers [Array of node elements]\n\t * @return {void}\n\t */\n\tregisterTriggers( ...triggers ) {\n\t\ttriggers.filter( Boolean ).forEach( ( trigger ) => {\n\t\t\ttrigger.addEventListener( 'click', ( event ) =>\n\t\t\t\tthis.showModal( event )\n\t\t\t);\n\t\t} );\n\t}\n\n\tshowModal( event = null ) {\n\t\tthis.activeElement = document.activeElement;\n\t\tthis.modal.classList.add( this.openClass );\n\t\tthis.addEventListeners();\n\t\tthis.setFocusToFirstNode();\n\t}\n\n\tcloseModal( event = null ) {\n\t\tconst modal = this.modal;\n\t\tthis.removeEventListeners();\n\n\t\tif ( this.activeElement && this.activeElement.focus ) {\n\t\t\tthis.activeElement.focus();\n\t\t}\n\n\t\tmodal.classList.remove( this.openClass );\n\t}\n\n\tcloseModalById( targetModal ) {\n\t\tthis.modal = document.getElementById( targetModal );\n\t\tif ( this.modal ) this.closeModal();\n\t}\n\n\taddEventListeners() {\n\t\tthis.modal.addEventListener( 'touchstart', this.onClick );\n\t\tthis.modal.addEventListener( 'click', this.onClick );\n\t\tdocument.addEventListener( 'keydown', this.onKeydown );\n\t}\n\n\tremoveEventListeners() {\n\t\tthis.modal.removeEventListener( 'touchstart', this.onClick );\n\t\tthis.modal.removeEventListener( 'click', this.onClick );\n\t\tdocument.removeEventListener( 'keydown', this.onKeydown );\n\t}\n\n\tonClick( event ) {\n\t\tif (\n\t\t\tevent.target.classList.contains( this.closeTrigger ) ||\n\t\t\tevent.target.parentNode.classList.contains( this.closeTrigger ) ||\n\t\t\tevent.target.classList.contains(\n\t\t\t\t'wp-block-cloudcatch-simple-modal-block__wrapper'\n\t\t\t)\n\t\t) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\tthis.closeModal( event );\n\t\t}\n\t}\n\n\tonKeydown( event ) {\n\t\tif ( event.keyCode === 27 ) this.closeModal( event ); // esc\n\t\tif ( event.keyCode === 9 ) this.retainFocus( event ); // tab\n\t}\n\n\tgetFocusableNodes() {\n\t\tconst nodes = this.modal.querySelectorAll( this.focusableElements );\n\t\treturn Array( ...nodes );\n\t}\n\n\t/**\n\t * Tries to set focus on a node which is not a close trigger\n\t * if no other nodes exist then focuses on first close trigger\n\t */\n\tsetFocusToFirstNode() {\n\t\tconst focusableNodes = this.getFocusableNodes();\n\n\t\t// no focusable nodes\n\t\tif ( focusableNodes.length === 0 ) return;\n\n\t\t// remove nodes on whose click, the modal closes\n\t\t// could not think of a better name :(\n\t\tconst nodesWhichAreNotCloseTargets = focusableNodes.filter(\n\t\t\t( node ) => {\n\t\t\t\treturn ! node.classList.contains( this.closeTrigger );\n\t\t\t}\n\t\t);\n\n\t\tif ( nodesWhichAreNotCloseTargets.length > 0 )\n\t\t\tnodesWhichAreNotCloseTargets[ 0 ].focus();\n\t\tif ( nodesWhichAreNotCloseTargets.length === 0 )\n\t\t\tfocusableNodes[ 0 ].focus();\n\t}\n\n\tretainFocus( event ) {\n\t\tlet focusableNodes = this.getFocusableNodes();\n\n\t\t// no focusable nodes\n\t\tif ( focusableNodes.length === 0 ) return;\n\n\t\t/**\n\t\t * Filters nodes which are hidden to prevent\n\t\t * focus leak outside modal\n\t\t */\n\t\tfocusableNodes = focusableNodes.filter( ( node ) => {\n\t\t\treturn node.offsetParent !== null;\n\t\t} );\n\n\t\tconst focusedItemIndex = focusableNodes.indexOf(\n\t\t\tdocument.activeElement\n\t\t);\n\n\t\tif ( event.shiftKey && focusedItemIndex === 0 ) {\n\t\t\tfocusableNodes[ focusableNodes.length - 1 ].focus();\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tif (\n\t\t\t! event.shiftKey &&\n\t\t\tfocusableNodes.length > 0 &&\n\t\t\tfocusedItemIndex === focusableNodes.length - 1\n\t\t) {\n\t\t\tfocusableNodes[ 0 ].focus();\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import Modal from './view/modal';\n\nwindow.addEventListener( 'DOMContentLoaded', () => {\n\t'use strict';\n\n\tconst generateTriggerMap = ( triggers, triggerAttr ) => {\n\t\tconst triggerMap = [];\n\n\t\ttriggers.forEach( ( trigger ) => {\n\t\t\tconst targetModal = trigger.attributes[ triggerAttr ].value;\n\t\t\tif ( triggerMap[ targetModal ] === undefined )\n\t\t\t\ttriggerMap[ targetModal ] = [];\n\t\t\ttriggerMap[ targetModal ].push( trigger );\n\t\t\t// trigger.removeAttribute( 'data-trigger-modal' );\n\t\t} );\n\n\t\treturn triggerMap;\n\t};\n\n\tconst modals = document.querySelectorAll(\n\t\t'.wp-block-cloudcatch-simple-modal-block__wrapper'\n\t);\n\n\tmodals.forEach( ( modal ) => {\n\t\tconst modalId = modal.getAttribute( 'data-modal-id' );\n\t\tconst modalSelector = modal.getAttribute( 'data-trigger-selector' );\n\t\tconst modalDelay = parseInt(\n\t\t\tmodal.getAttribute( 'data-trigger-delay' )\n\t\t);\n\n\t\tconst options = Object.assign(\n\t\t\t{},\n\t\t\t{ openTrigger: 'data-trigger-modal' }\n\t\t);\n\n\t\tconst triggers = [\n\t\t\t...document.querySelectorAll(\n\t\t\t\t`[${ options.openTrigger }=\"${ modalId }\"]`\n\t\t\t),\n\t\t\t...document.querySelectorAll( `${ modalSelector }` ),\n\t\t];\n\n\t\toptions.targetModal = modalId;\n\t\toptions.triggers = triggers;\n\n\t\tconst init = new Modal( options );\n\n\t\tif ( modalDelay ) {\n\t\t\tsetTimeout( () => init.showModal(), modalDelay );\n\t\t}\n\t} );\n} );\n"],"names":["Modal","openTrigger","closeTrigger","openClass","focusableElements","constructor","_ref","targetModal","triggers","modal","document","querySelector","length","registerTriggers","onClick","bind","onKeydown","_len","arguments","Array","_key","filter","Boolean","forEach","trigger","addEventListener","event","showModal","undefined","activeElement","classList","add","addEventListeners","setFocusToFirstNode","closeModal","removeEventListeners","focus","remove","closeModalById","getElementById","removeEventListener","target","contains","parentNode","preventDefault","stopPropagation","keyCode","retainFocus","getFocusableNodes","nodes","querySelectorAll","focusableNodes","nodesWhichAreNotCloseTargets","node","offsetParent","focusedItemIndex","indexOf","shiftKey","window","generateTriggerMap","triggerAttr","triggerMap","attributes","value","push","modals","modalId","getAttribute","modalSelector","modalDelay","parseInt","options","Object","assign","init","setTimeout"],"sourceRoot":""}